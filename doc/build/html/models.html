<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Managing Models and Instruments &mdash; Lab Instrument Control and Automation Framework 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Lab Instrument Control and Automation Framework 1.0 documentation" href="index.html" />
    <link rel="next" title="Using the Test Framework" href="tests.html" />
    <link rel="prev" title="Managing Resources" href="resources.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tests.html" title="Using the Test Framework"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="resources.html" title="Managing Resources"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Lab Instrument Control and Automation Framework 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="managing-models-and-instruments">
<h1>Managing Models and Instruments<a class="headerlink" href="#managing-models-and-instruments" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="_images/instruments.png"><img alt="_images/instruments.png" src="_images/instruments.png" /></a>
<p>Instruments are Python objects that are linked to physical devices on a local
or remote machine. Many different machines may connect to the same physical
device because all communication is arbitrated by the InstrumentManager
running on the computer where the physical device is connected.</p>
<p>All of the attributes and methods contained in an Instrument object are copied
from the a Model object on the machine where the device is connected. In order
to connect to an Instrument, a Model must first be loaded.</p>
<div class="section" id="loading-and-unloading-models">
<h2>Loading and Unloading Models<a class="headerlink" href="#loading-and-unloading-models" title="Permalink to this headline">¶</a></h2>
<p>Models are typically handled automatically by the InstrumentManager. There are
a few cases, however, when you would need to manually load or unload a Model.
These cases are:</p>
<div class="highlight-python"><div class="highlight"><pre>* Multiple compatible Models exist, and the autoloader picked the wrong
Model
* The Controller does not support enumeration or autoloading Models
* The Controller Resource was created manually
* The Model you wish to load is not considered compatible (experimental
code, etc.)
</pre></div>
</div>
<p>To load a Model for a resource, you must get the UUID of the resource and then
unload any existing Model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">instr</span> <span class="o">=</span> <span class="n">InstrumentControl</span><span class="p">()</span>

<span class="n">uuid</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">findResource</span><span class="p">(</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="s">&#39;ASRL::9&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">instr</span><span class="o">.</span><span class="n">unloadModel</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
</pre></div>
</div>
<p>Then specify a package name and class name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">instr</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="s">&#39;models.Tektronix.Oscilloscope.m_DigitalPhosphor&#39;</span><span class="p">,</span> <span class="s">&#39;m_DigitalPhosphor&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details, see <code class="xref py py-func docutils literal"><span class="pre">InstrumentControl.unloadModel()</span></code> and
<code class="xref py py-func docutils literal"><span class="pre">InstrumentControl.loadModel()</span></code></p>
</div>
<div class="section" id="connecting-to-instruments">
<h2>Connecting to Instruments<a class="headerlink" href="#connecting-to-instruments" title="Permalink to this headline">¶</a></h2>
<p>InstrumentControl can connect to any Instrument on any machine that has been
added using <code class="xref py py-func docutils literal"><span class="pre">InstrumentControl.addManager()</span></code>. You can find instruments by:</p>
<blockquote>
<div><ul class="simple">
<li>Type</li>
<li>Model Number</li>
<li>Serial Number</li>
</ul>
</div></blockquote>
<p>Looking up instruments by Type and Model Number may return multiple instruments
if there are many devices connected. In these cases, InstrumentControl will
return a list of devices that match. The programmer will have to use other
logic to determine which device to use. The easiest way to deal with this
situation is to identify a device by serial number, though there is always the
possibility that devices from different vendors could have the same serial
number.</p>
<p>To connect to instruments by type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">scope</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">getInstrument_type</span><span class="p">(</span><span class="s">&#39;Oscilloscope&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To connect to instruments by Model number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">smu</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">getInstrument_model</span><span class="p">(</span><span class="s">&#39;B2902A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To connect to instruments by Serial number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dev</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">getInstrument_serial</span><span class="p">(</span><span class="s">&#39;12345&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To get a list of all instruments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">all</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">getInstrument_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="using-instruments">
<h2>Using Instruments<a class="headerlink" href="#using-instruments" title="Permalink to this headline">¶</a></h2>
<p>Instruments can be used like any Python object, with some limitations. Under
the hood, Instruments are an RPC-endpoint connected to a socket on the
InstrumentManager. While this whole process should be mostly transparent to
both the user and the developer, some things are limited:</p>
<div class="highlight-python"><div class="highlight"><pre>* Only methods can be called, it is not possible to access object attributes
* Accessing or Modifying attributes can only be done by wrapping the
attribute in a set of methods (getters and setters)
* Methods that begin with &#39;_&#39; are considered protected and cannot be
accessed
* The RPC subsystem introduces 2-20 milliseconds of latency
</pre></div>
</div>
<p>see <a class="reference internal" href="supported_instruments.html"><em>Supported Instruments</em></a> for further
documentation on each instrument.</p>
</div>
<div class="section" id="using-collectors">
<h2>Using Collectors<a class="headerlink" href="#using-collectors" title="Permalink to this headline">¶</a></h2>
<p>In some applications, it may be beneficial to collect data at a regular and
precise intervals. Collectors serve this purpose by running regularly within
the InstrumentManager to prevent network latency from skewing data samples.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure to take into account the amount of time it takes to retrieve data
from a physical device. This will depend on the interface used, the data
transfer rate, operating system overhead and the process priority. This will
limit how quickly you will be able to collect data.</p>
</div>
<p>To start a collector, you must tell the Model which function you would like to
call, how often you would like to call it and how to interpret the returned
data. This is done by calling <a href="#id1"><span class="problematic" id="id2">:function:`startCollector`</span></a> on the Instrument
object.</p>
<dl class="class">
<dt id="models.m_Base">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">m_Base</code><span class="sig-paren">(</span><em>uuid</em>, <em>controller</em>, <em>resID</em>, <em>VID</em>, <em>PID</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/models.html#m_Base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#models.m_Base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="models.m_Base.startCollector">
<code class="descname">startCollector</code><span class="sig-paren">(</span><em>method</em>, <em>interval</em>, <em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/models.html#m_Base.startCollector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#models.m_Base.startCollector" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts a Collector thread to retrieve data at a regular interval.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the Model method to invoke</li>
<li><strong>interval</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Interval in milliseconds between method invokations</li>
<li><strong>callback</strong> (<em>method</em>) &#8211; Method to call with returned data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean, True if successful, False otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre>instr = InstrumentControl()

dev = instr.getInstrument_list()[0]

dev.startCollector(&#39;getMeasurement&#39;, 100, lambda x: print x)
</pre></div>
</div>
<p>To stop a collector, notify the Model by calling <cite>stopCollector</cite> with the
name of the method.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dev</span><span class="o">.</span><span class="n">stopCollector</span><span class="p">(</span><span class="s">&#39;getMeasurement&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To change the interval time, call the <cite>startCollector</cite> method with the new
interval. Only one collector can be running at a time for each method, so the
old collector will be destroyed and a new one will be created.</p>
<p>Retrieving data from collectors</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Managing Models and Instruments</a><ul>
<li><a class="reference internal" href="#loading-and-unloading-models">Loading and Unloading Models</a></li>
<li><a class="reference internal" href="#connecting-to-instruments">Connecting to Instruments</a></li>
<li><a class="reference internal" href="#using-instruments">Using Instruments</a></li>
<li><a class="reference internal" href="#using-collectors">Using Collectors</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="resources.html"
                        title="previous chapter">Managing Resources</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tests.html"
                        title="next chapter">Using the Test Framework</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/models.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tests.html" title="Using the Test Framework"
             >next</a> |</li>
        <li class="right" >
          <a href="resources.html" title="Managing Resources"
             >previous</a> |</li>
        <li><a href="index.html">Lab Instrument Control and Automation Framework 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, KKENNEDY.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>